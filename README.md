# CVE-2020-11932 :bug::mag:

Check CVE-2020-11932 and test for host relating to this vulnerability

## Usage
### Download
```console
git clone https://github.com/Staubgeborener/CVE-2020-11932
cd CVE-2020-11932.sh
chmod +x cve-2020-11932.sh
./cve-2020-11932.sh
```

### With curl (so no download)
```console
bash <(curl -s https://raw.githubusercontent.com/Staubgeborener/CVE-2020-11932/master/cve-2020-11932.sh)
```

## What is this?
Kind of a proof of concept of the vulnerability [https://nvd.nist.gov/vuln/detail/CVE-2020-11932](CVE-2020-11932). It's possible, that the `Ubuntu Server` logs the password of the `LUKS` full disk encryption in *plain text*. This one is tested on `Ubuntu Server 20.04`.

Created `LUKS` encryption (`LVM`) with password `T0pS3cr3tP4ssw0rd`. We can find five files that contain the password in plain text `sudo grep -Rl "T0pS3cr3tP4ssw0rd"`:
* subiquity-curtin-install.conf
* curtin-install-cfg.yaml
* curtin-install.log
* installer-journal.txt
* autoinstall-user-data

![alt_text](https://github.com/Staubgeborener/CVE-2020-11932/blob/master/media/1.PNG)
![alt_text](https://github.com/Staubgeborener/CVE-2020-11932/blob/master/media/2.PNG)
![alt_text](https://github.com/Staubgeborener/CVE-2020-11932/blob/master/media/3.PNG)
![alt_text](https://github.com/Staubgeborener/CVE-2020-11932/blob/master/media/4.PNG)
![alt_text](https://github.com/Staubgeborener/CVE-2020-11932/blob/master/media/5.PNG)
![alt_text](https://github.com/Staubgeborener/CVE-2020-11932/blob/master/media/6.PNG)

After running `cve-2020-11932.sh` you will get an output like this:
![alt_text](https://github.com/Staubgeborener/CVE-2020-11932/blob/master/media/7.PNG)
